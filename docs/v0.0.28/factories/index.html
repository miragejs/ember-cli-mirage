<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Factories &middot; Ember CLI Mirage
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/style.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>
    <div class="Topbar">
      <div class="Container">
      </div>
    </div>

    <header class="Header">
  <div class="Container">
    <nav class='Header__nav'>
      <ul class='Header__nav-list'>
        <li class='Header__nav-item'>
          <a href='/docs/v0.4.x' class="Header__nav-item-link active">
            <span class="u-mobile">Docs</span>
            <span class="u-desktop">Documentation</span>
          </a>
        </li>
        <li class='Header__nav-item'>
          <a href='/blog' class="Header__nav-item-link">Blog</a>
        </li>
        <li class='Header__nav-item'>
          <a href='/about' class="Header__nav-item-link">About</a>
        </li>
        <li class='Header__nav-item'>
          <a href="https://github.com/samselikoff/ember-cli-mirage" class='Header__nav-item-link' target="_blank">GitHub</a>
        </li>
      </ul>
    </nav>
    <a class="Header__logo" href="/">
      <span class='Header__logo-minor'>Ember CLI</span><br>
      <span class='Header__logo-major'>Mirage</span>
    </a>
  </div>
</header>


    <div class="Wrapper">
      <div class="Content">
        

<div class="Side-panel">

  <div class="Mobile-nav">
    <select class="Mobile-nav__toc" onchange="if (this.value) window.location.href=this.value">
      <option value="">Navigate the docs...</option>
      
        


  
  <optgroup label='Getting started'>

<option value="/docs/v0.0.28/">Overview</option>


      
        


<option value="/docs/v0.0.28/installation/">Installation</option>


      
        


<option value="/docs/v0.0.28/quickstart/">Quickstart</option>


      
        


  
    </optgroup>
  
  <optgroup label='Writing your server'>

<option value="/docs/v0.0.28/defining-routes/">Defining routes</option>


      
        


<option value="/docs/v0.0.28/seeding-your-database/">Seeding your database</option>


      
        


<option value="/docs/v0.0.28/acceptance-testing/">Acceptance testing</option>


      
        


  
    </optgroup>
  
  <optgroup label='API reference'>

<option value="/docs/v0.0.28/server-configuration/">Server configuration</option>


      
        


<option value="/docs/v0.0.28/routes/">Routes</option>


      
        


<option value="/docs/v0.0.28/shorthands/">Shorthands</option>


      
        


<option value="/docs/v0.0.28/database/">Database</option>


      
        


<option value="/docs/v0.0.28/factories/">Factories</option>

  </optgroup>


      
    </select>

    <div class="Mobile-nav__version">
      <span class='Mobile-nav__version-label'>Version: </span>
      <select class='Mobile-nav__version-select' onchange="if (this.value) window.location.href=this.value">
        
          <option value="/docs/v0.4.x" >v0.4.x</option>
        
          <option value="/docs/v0.3.x" >v0.3.x</option>
        
          <option value="/docs/v0.2.x" >v0.2.x</option>
        
          <option value="/docs/v0.1.x" >v0.1.x</option>
        
          <option value="/docs/v0.0.29" >v0.0.29</option>
        
          <option value="/docs/v0.0.28" selected >v0.0.28</option>
        
          <option value="/docs/v0.0.27" >v0.0.27</option>
        
      </select>
    </div>
  </div>

  <div class="Desktop-nav">
    <div class="Desktop-nav__version">
      <span class="Desktop-nav__version-label">Version: </span>
      <select class='Desktop-nav__version-select' onchange="if (this.value) window.location.href=this.value">
        
        <option value="/docs/v0.4.x" >v0.4.x</option>
        
        <option value="/docs/v0.3.x" >v0.3.x</option>
        
        <option value="/docs/v0.2.x" >v0.2.x</option>
        
        <option value="/docs/v0.1.x" >v0.1.x</option>
        
        <option value="/docs/v0.0.29" >v0.0.29</option>
        
        <option value="/docs/v0.0.28" selected >v0.0.28</option>
        
        <option value="/docs/v0.0.27" >v0.0.27</option>
        
      </select>
    </div>

    <ul class="Desktop-nav__toc">
      
        
          <li class='Desktop-nav__section'>Getting started</li>
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/">
    Overview
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/installation/">
    Installation
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/quickstart/">
    Quickstart
  </a>
</li>

      
        
          <li class='Desktop-nav__section'>Writing your server</li>
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/defining-routes/">
    Defining routes
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/seeding-your-database/">
    Seeding your database
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/acceptance-testing/">
    Acceptance testing
  </a>
</li>

      
        
          <li class='Desktop-nav__section'>API reference</li>
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/server-configuration/">
    Server configuration
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/routes/">
    Routes
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/shorthands/">
    Shorthands
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item " href="/docs/v0.0.28/database/">
    Database
  </a>
</li>

      
        

        

<li>
  <a class="Desktop-nav__item active" href="/docs/v0.0.28/factories/">
    Factories
  </a>
</li>

      
    </ul>
  </div>
</div>


<div class="Center-panel">

  <div class="Docs-page">
    <div class='Docs-page__header'>
      <div class="Docs-page__version">
        <a class='Docs-page__improve' href="https://github.com/samselikoff/ember-cli-mirage/edit/gh-pages/docs/v0.0.28/factories.md">
          <small>
            <img class='Docs-page__improve-img' src="/public/images/edit.png" alt="">
            <span class='Docs-page__improve-text'>Improve this page</span>
          </small>
        </a>
      </div>
      <h1 class='Docs-page__title'>Factories</h1>
    </div>

    <div class='Docs-page__content'>
      <p>Factories are used in your tests. Their purpose is to make it easy to populate your Mirage server’s database with data. Whenever you generate an object via a factory, it will automatically get added to the database, and thus get an autoassigned <code class="highlighter-rouge">id</code>.</p>

<p>You define factories by creating files under <code class="highlighter-rouge">/mirage/factories/some-factory.js</code>. The name of the factory, which you reference in your tests, is determined by the filename.</p>

<p>Factories have attributes, and you create objects from factory definitions using <code class="highlighter-rouge">create</code> and <code class="highlighter-rouge">createList</code>.</p>

<h2 id="defining-factories">Defining factories</h2>

<p>Attributes can be static (strings, numbers or booleans) or dynamic (a function). Here’s a factory with some static attributes:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// mirage/factories/user.js</span>
<span class="k">import</span> <span class="nx">Mirage</span> <span class="k">from</span> <span class="s1">'ember-cli-mirage'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Mirage</span><span class="p">.</span><span class="nx">Factory</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="s1">'Link'</span><span class="p">,</span>
  <span class="na">age</span><span class="p">:</span> <span class="mi">563</span><span class="p">,</span>
  <span class="na">evil</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Functions receive the sequence number <em>i</em> as an argument, which is useful to create dynamic attributes:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// mirage/factories/user.js</span>
<span class="k">import</span> <span class="nx">Mirage</span> <span class="k">from</span> <span class="s1">'ember-cli-mirage'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Mirage</span><span class="p">.</span><span class="nx">Factory</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'User'</span> <span class="o">+</span> <span class="nx">i</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>The first user generated (per test) would have a name of <code class="highlighter-rouge">User 0</code>, the second a name of <code class="highlighter-rouge">User 1</code>, and so on.</p>

<aside class="Docs-page__aside">
  <p>Currently, you cannot reference dynamic attributes, although this is [in the works](https://github.com/samselikoff/ember-cli-mirage/issues/27).</p>
</aside>

<p>Finally, you can also reference static attributes (numbers, strings or booleans) within your dynamic attributes via <code class="highlighter-rouge">this</code>:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// mirage/factories/contact.js</span>
<span class="k">import</span> <span class="nx">Mirage</span> <span class="k">from</span> <span class="s1">'ember-cli-mirage'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Mirage</span><span class="p">.</span><span class="nx">Factory</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">age</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
  <span class="na">is_admin</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>You should define the attributes of your factory as the “base case” for your objects, and override them within your tests. We’ll discuss how do to this in the Creating Objects section.</p>

<h2 id="extending-factories">Extending factories</h2>

<p>You can extend factories:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// mirage/factories/human.js</span>
<span class="k">import</span> <span class="nx">Mirage</span> <span class="k">from</span> <span class="s1">'ember-cli-mirage'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Mirage</span><span class="p">.</span><span class="nx">Factory</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">species</span><span class="p">:</span> <span class="s1">'homo sapiens'</span>
<span class="p">});</span>

<span class="c1">// mirage/factories/man.js</span>
<span class="k">import</span> <span class="nx">Human</span> <span class="k">from</span> <span class="s1">'./human'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Human</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">gender</span><span class="p">:</span> <span class="s1">'male'</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="creating-objects">Creating objects</h2>

<p>Once you’ve defined a factory for a model, you can generate data for that model using <code class="highlighter-rouge">server.create</code> and <code class="highlighter-rouge">server.createList</code> from within your acceptance tests.</p>

<p><a name="create" href="#create">#</a> server.<b>create</b>(<i>type</i> [, <i>attrs</i>])</p>

<p>Generates a single model of type <em>type</em>, inserts it into the database (giving it an id), and returns the data that was
added.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">test</span><span class="p">(</span><span class="s2">"I can view a contact's details"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">contact</span> <span class="o">=</span> <span class="nx">server</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'contact'</span><span class="p">);</span>

  <span class="nx">visit</span><span class="p">(</span><span class="s1">'/contacts/'</span> <span class="o">+</span> <span class="nx">contact</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>

  <span class="nx">andThen</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">equal</span><span class="p">(</span> <span class="nx">find</span><span class="p">(</span><span class="s1">'h1'</span><span class="p">).</span><span class="nx">text</span><span class="p">(),</span> <span class="s1">'The contact is Link'</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<p>You can override the attributes from the factory definition with a
hash passed in as the second parameter. For example, if we had this factory</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="k">default</span> <span class="nx">Mirage</span><span class="p">.</span><span class="nx">Factory</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="s1">'Link'</span>
<span class="p">});</span>
</code></pre></div></div>

<p>we could override the name like this:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">test</span><span class="p">(</span><span class="s2">"I can view the contacts"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">server</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'contact'</span><span class="p">,</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'Zelda'</span> <span class="p">});</span>

  <span class="nx">visit</span><span class="p">(</span><span class="s1">'/'</span><span class="p">);</span>

  <span class="nx">andThen</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">equal</span><span class="p">(</span> <span class="nx">find</span><span class="p">(</span><span class="s1">'p'</span><span class="p">).</span><span class="nx">text</span><span class="p">(),</span> <span class="s1">'Zelda'</span> <span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<p><a name="createList" href="#createList">#</a> server.<b>createList</b>(<i>type</i>, <i>amount</i> [, <i>attrs</i>])</p>

<p>Creates <em>amount</em> models of type <em>type</em>, optionally overriding the attributes from the factory with <em>attrs</em>.</p>

<p>Returns the array of records that were added to the database.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">test</span><span class="p">(</span><span class="s2">"I can view the contacts"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">server</span><span class="p">.</span><span class="nx">createList</span><span class="p">(</span><span class="s1">'contact'</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">youngContacts</span> <span class="o">=</span> <span class="nx">server</span><span class="p">.</span><span class="nx">createList</span><span class="p">(</span><span class="s1">'contact'</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">{</span> <span class="na">age</span><span class="p">:</span> <span class="mi">15</span> <span class="p">});</span>

  <span class="nx">visit</span><span class="p">(</span><span class="s1">'/'</span><span class="p">);</span>

  <span class="nx">andThen</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">equal</span><span class="p">(</span><span class="nx">currentRouteName</span><span class="p">(),</span> <span class="s1">'index'</span><span class="p">);</span>
    <span class="nx">equal</span><span class="p">(</span> <span class="nx">find</span><span class="p">(</span><span class="s1">'p'</span><span class="p">).</span><span class="nx">length</span><span class="p">,</span> <span class="mi">10</span> <span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

    </div>

    

<div class='Docs-page-nav'>
  
    
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
      
      
      
        
  
         <a class="Docs-page-nav__link u-first" href="/docs/v0.0.28/database/">< Database</a>
      
  
    
  
  
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
    
    
  
  
    
</div>

  </div>
</div>

      </div>
    </div>

    <footer class="Footer">
  <div class="Container Grid Grid--gutters Grid--full med-Grid--fit">
    <div class="Grid-cell">
      <p>Project and site maintained by <a href="https://twitter.com/samselikoff">Sam Selikoff</a> and <a href="https://github.com/samselikoff/ember-cli-mirage/graphs/contributors">contributors</a>.</p>
      <p>Sponsored by <a href="https://embermap.com/">EmberMap</a>.<p>
    </div>
    <div class="Grid-cell">
      <div class="Github-stars">
        <iframe src="https://ghbtns.com/github-btn.html?user=samselikoff&repo=ember-cli-mirage&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js"></script>
<script>
  /* global anchors */
  // anchors.options = {
  //   placement: 'left',
  //   visible: 'always'
  // };
  anchors.add('h2:not(.Home-page__feature-heading)');
</script>


  </body>
</html>
